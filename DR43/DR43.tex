\documentclass[a4paper,11pt,pdf]{pacmanreport}

%%=== Aditional packages
\usepackage{amsmath}
\usepackage{amsfonts}

% The following is used to make packages hyperref and cite work together
\makeatletter
\let\NAT@parse\undefined
\makeatother
\usepackage[bookmarks=true,hyperfootnotes=true,colorlinks=true,linkcolor=blue,anchorcolor=blue,citecolor=blue,urlcolor=blue,filecolor=blue]{hyperref}

%%=== Local definitions
\graphicspath{{images/}{../shared_images/}}

%% ================================
%% PROJECT INFO

\project{}
\projectid{FP7-IST-60918}
\projectstart{1 March 2013}
\duration{36}

%% ================================
%% DELIVERABLE INFO

\title{Methodologies for grasp acquisition and planning}
\deliverableid{DR 4.3}
\author{H. Marino, C.J.~Rosales, M. Kopicki, G. Santaera, E. Luberto, Y. Wu, A. Artoni, G. Pannocchia, M. Gabiccini, and J.L.~Wyatt}
\address{University of Birmingham, UK}
\email{jlw@cs.bham.ac.uk}
\headertitle{Grasp acquisition and planning}
\headerauthor{H. Marino, et al.}

\duedate{2016-02-29}
\submissiondate{2016-02-29}
\leadpartner{University of Birmingham, UK}
\revision{final}
\disseminationlevel{PU}


%% UNCOMMENT: to get the logo; if you've copied this file to a directory yearX/wpY/ then this should work
\reportlogo{pacmanlogo.png}


\begin{document}

\maketitle

\begin{abstract}
\noindent This report describes the activities related to \emph{planning and  control of grasping actions} given the complete or partial detection of an object. It includes work on: modelling underactuated and adaptive robotic hands, learning grasps for underactuated hands and transferring them robustly to different initial hand-object poses, adjusting hand pose via infrared sensor readings to grasp objects in an uncertain configuration with the respect to that perceived by vision, planning complex grasping and manipulation tasks either using discrete search methods or via direct trajectory optimization methods for systems with unspecified contact sequences.
\end{abstract}


\vspace{.2em}
\hrule

\footnotesize

\tableofcontents

\normalsize

\newpage

\section*{Executive Summary}

This report describes the activities --- most of which are already performed, while some others scheduled for finalization in the weeks that precede the PaCMan review meeting in Aprile 2016 --- within the PaCMan consortium to define methodologies for \emph{grasp acquisition and planning}. The material included in this report describes the results that fall under Task 4.3 (M 7-30), and Task 4.4 (M 1-36) at M 36.

\section*{Role of incipient grasp evaluation in PaCMan}

This deliverable documents the effort of the consortium in devising new strategies to define \emph{practical} approaches to tackle the problem of \emph{grasping under uncertainty and novelty}, either caused by clutter, visual occlusions, or new object shapes. To this sake, the ability to evaluate \emph{incipient grasps} in terms of their expected quality, robustness, and probability of success, is of paramount importance.

\section*{Contribution to the PaCMan scenario}

To our eyes, grasp methodologies that try to cope with pose uncertainty, object shape estimation inaccuracies, clutter and partial occlusions by both (i) accomodating grasp unmodelled dynamics by exploiting prior knowledge about the adaptivity and the compliance of the Pisa/IIT SoftHand, and (ii) by inferring grasps for novel objects from as little as one training example (of a chosen grasp type) that are shown to be generalizable within and \emph{across} object categories, even with partial shape information, represent central contributions in the scenario depicted in the PaCMan project.


\newpage

\section{Tasks, objectives, results}

\subsection{Planned work}
The selection of correct grasp strategies when the object to be grasped in unknown or only partially visible seems a pretty easy task for humans.
On the contrary, though robotics has made significant progress in the field of autonomous grasping, the problem of grasping novel objects in cluttered scenarios has not been completely solved yet. In this report, we document the activities of the consortium to tackle this problem.

The work to be documented in this report is concerned with the definition of: ``Methodologies for grasp acquisition and planning''. This should mostly contain the results of Task 4.4. In particular, the report should contain the definition of feasibility analysis of grasping under uncertainty as a belief space planning problem, feasibility analysis for extending Monte-Carlo tree search methods to continuous state-action space, algorithm design for the chosen approach.

%% Input from Claudio
% In Task 4.4 we posed the problem of grasping as a problem of motion planning under uncertainty. We planned to implement and evaluate a motion planning algorithm in a physics based simulation, prior to transfer to a real robot. The requirement was for an algorithm that could provide robust reach to grasp trajectories in the face of object pose and shape uncertainty, planning for and taking advantage of tactile contacts. We considered both methods that plan explicitly in belief space, and those that embed information from observations in the physical space. We elected to pursue the latter route.


\subsection{Actual work performed}

%We have to clearly state, right away, that not all the pieces of work presented in this report, even if sharing the very same goals of WP4, i.e., ``to develop methods to control grasping actions given a detection of an object using the compositional object model'', fit exactly the breakdown structure suggested by the Tasks reported in the ``Description of Work''. In particular, the description of the activities to be performed in Tasks 4.1, 4.2 and 4.3, represents the sequential temporal stages that one could envision in performing a robust grasp when adopting a fully actuated and sensorized robotic hand. In fact, the pre-shaping of the hand to a first object contact (Task 4.1), the assessment of the first-order properties of the object surface, along with the local optimization of the contact point locations (Task 4.2), and the actual grasp acquisition with the optimal distribution of contact forces (Task 4.3), indeed assume that the action is performed by employing a dexterous hand with a plethora of force and position sensors. Moreover, here the robustness of the grasp was envisioned by reasoning, at each stage of the process, whether the previous step was successfully performed and taking proper corrective actions if that was not the case.
%
%The approach that we came to pursue sees instead a central role of compliantly underactuated hands, where uncertainty in the relative pose between the hand and the object and object shape itself is mechanically absorbed by the adaptive behavior of the Pisa/IIT SoftHand. This new research direction brought about somewhat completely unplanned (and unexplored) issues that we considered central to the goals of WP4 and worth to be pursued. First of all, the sensorization of a compliantly adaptive hand with dislocable joints asked for a whole new approach to provide proprioceptive feedback to the hand (this topic is actually matter of DR~3.1). The force sensorization problem, which is somewhat assumed in the Tasks~4.2 and~4.3, poses non trivial technological problems for the hand under investigation, and is still under development and testing. Moreover, the envisioned phases to transit from grasp formation to successful grasp acquisition are inextricably entangled and somehow blurred for an adaptive and underactuated hand with just one single Degree of Actuation, as the dynamic interaction between the hand and the object --- and possibly the environment --- is responsible for the global behavior of the system. This new perspective asked for a rescheduling and reorganization of the needed pieces of work.
%
%For the reasons mentioned above, the work that is presented in this report is mostly focused on proposing robust grasping solution for an adaptive hand and, in particular, for our Pisa/IIT SoftHand. The learning and transfer of grasps within and across object categories, instead, makes use of the fully actuated and sensorized 20-DoF DLR-HIT Hand II, since a finer control over the fingertip position is required.

Sec.~\ref{sec:HighLevelPlanning} presents our approach to solve the planning problem related to moving objects from one location to another, possibly by using handoffs, table support, and regrasping. This work constituted the theoretical foundation for the high-level planning needed to perform Task 5.3 at M24. The planner has now been tested (in simulation) also in more complex scenarios, with respect to bimanual object passing, with promising results.
The good level of maturity reached by the work is testified by the journal publication in~\ref{ann:highLevelPlanning}.

In Sec.~\ref{sec:LearningInferenceUnderactuatedHands}, we present the adaptation to underactuated robotic hands of the grasp planning algorithm previously devised only for fully actuated hands --- the DLR-HIT Hand II was used last year by the University of Birmingham. Our approach, by using a product of experts, learns now not only the desired final grasp, but also good grasping trajectories from rigid body simulations of the Pisa/IIT SoftHand. The new method shows that it is possible to use just a few example grasps in order to be able to transfer this knowledge to unknown, even partially visible objects. More details can be found in~\ref{ann:LearningInferenceUnderactuatedHands}.

In Sec.~\ref{sec:DataDrivenMovementAnalysis}, ...

%In Sec.~\ref{sec:GraspingUncertainty}, we consider the grasps of the previous section as the starting point, but now wish to execute them more reliably than in an essentially open loop fashion. We present the progress on our method for planning tactile information gathering to reduce the uncertainty in the pose of an object. The method works by embedding the information to be gained in the physical space, using it to shorten distances, and thus make information gathering trajectories of lower cost. We show improvement in our results over the previous year.


In Sec.~\ref{sec:ComputationalFramework}, we describe a planning strategy based on direct trajectory optimization that does not require a-priori specification of the contact sequence and presents, from the outset, the benefits of providing dynamically consistent plans and allowing for opportunistic exploitation of environmental constraints. This work has now reached a good level of maturity, as testified by the conference publication in~\ref{ann:env-awareManipulation}.

In Sec.~\ref{sec:OffsetFreeMPCExplained}, we focus on the description of model predictive control algorithms for nonlinear (and linear) discrete-time systems, with the intended objective of clarifying the main concepts needed to guarantee offset-free performances. A strong accent is put on the role played by the disturbance and the observer models, which are paramount to ensure the stability of MPC-based manipulation controllers derived from manipulation planners described in Sec.~\ref{sec:ComputationalFramework}.
 More details can be found in the conference publication in~\ref{ann:OffsetFreeMPCExplained}.

In Sec.~\ref{sec:IRSensorBasedGraspPlanning}, we ...

% \subsection{Relation to the state-of-the-art}
% How are the obtained results related to the state-of-the-art?
% This part is usually discussed in the corresponding subsection. Therefore, % a global 'Relation to the state-of-the-art' is unnecessary

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Work directly into the following .tex files

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: Marco GABICCINI
% High-Level Planning for Dual Arm Goal-Oriented Tasks
\input{./inputFiles/HighLevelPlanningDualArm.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: UoB team and by Hamal MARINO
% Learning and Inference of Dexterous Grasps for Novel Objects with
% Underactuated Hands
\input{./inputFiles/LearningInferenceUnderactuatedHands.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: Hamal MARINO
% Data-Driven Human Grasp Movement Analysis
\input{./inputFiles/DataDrivenMovementAnalysis.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: Marco GABICCINI
% Computational Framework for Environment-Aware Robotic Manipulation
% Planning
\input{./inputFiles/ComputationalFramework.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: Marco GABICCINI
% Offset-free MPC Explained: novelties, subtleties, and applications
% 
\input{./inputFiles/OffsetFreeMPCExplained.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% To be prepared by: Yier WU, Emanuele LUBERTO, and Gaspare SANTAERA
% Infrared sensor-based grasp planning
\input{./inputFiles/IRSensorBasedGraspPlanning.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage

\bibliographystyle{IEEEtran}
\bibliography{../shared_bibliography/abbreviations,./bibliography/DR43}

\newpage

\appendix
\section{Annexes}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Article: On the Problem of Moving Objects with Autonomous Robots: a Unifying High-Level Planning Approach} 
\label{ann:highLevelPlanning}
\begin{description}
    \item[Authors] H. Marino, M. Ferrati, A. Settimi, C. Rosales, M. Gabiccini
    \item[Info] Published in: Robotics and Automation Letters, IEEE. Date of Publication: January 18 2016. ISSN: 2377-3766;\\
         DOI: 10.1109/LRA.2016.2519149
    \item[Abstract] Moving objects with autonomous robots is a wide topic that includes single-arm pick-and-place tasks, object regrasping, object passing between two or more arms in the air or using support surfaces such as tables and similar. Each task has been extensively studied and many planning solutions are already present in the literature. In this paper we present a planning scheme which, based on the use of pre-defined elementary manipulation skills, aims to unify solutions which are usually obtained by means of different planning strategies rooted on hard-coded behaviors. Both robotic manipulators and environment fixed support surfaces are treated as end-effectors of movable and non-movable types, respectively. The task of the robot can thus be broken down into elementary building blocks, which are end-effector manipulation skills, that are then planned at the kinematic level. Feasibility is ensured by propagating unforeseen low-level failures at the higher level and by synthesizing different behaviors. The validity of the proposed solution is shown via experiments on a bimanual robot setup and in simulations involving a more complex setup similar to an assembly line.
    \item[Relation with the deliverable] this work is concerned with the problem of planning a grasp sequence to move one object from an initial configuration to a final one. Since the initial configuration is not known a priori, but has to be estimated using vision, nor the sequence of handoffs is pre-specified (but automatically synthesized), the present work contributes to the goals of Task 4.4.
    \item[Attachment] (following pages until next annex)
\end{description}
\includepdf[pages=-]{./attachedPapers/OnTheProblemOfMovingObjectsWithAutonomousRobots.pdf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Article: Learning and Inference of Dexterous Grasps for Novel Objects with Underactuated Hands}
\label{ann:LearningInferenceUnderactuatedHands}
\begin{description}
    \item[Authors] M. Kopicki, C. J. Rosales, H. Marino, M. Gabiccini, J. L. Wyatt
    \item[Info] Submitted to: {\color{red} update this and the attached PDF!}
    \item[Abstract] Recent advances have been made in learning of grasps for fully actuated hands. A typical approach learns the target locations of finger links on the object. When a new object must be grasped, new finger locations are generated, and a collision free reach-to-grasp trajectory is planned. Such a division of labour fails to transfer directly to underactuated hands, which improve grasp reliability via contacts with the object during grasping. In this paper we present a method for learning transferrable grasps for underactuated hands. Our approach learns not only the desired final grasp, and also good grasping trajectories, from a rigid body simulation. This enables us to learn how to approach the object and close the underactuated hand from a variety of poses. Our method does not rely on explicit representation of the contact sequence.
The core learning method uses product of experts. This allows grasp transfer to novel objects and works despite partial shape reconstruction of less than 25\% of the surface. From nine training grasps on three objects the method transferred grasps to previously unseen, novel objects, that differ significantly from the training objects, with an 80\% success rate. We move beyond previous work by: i) showing the ability to learn transferrable grasps for underactuated hands; ii) extending our learning
method to work with multiple training examples for each grasp
type; iii) extending our method to work with multiple reach to
grasp trajectories.
    \item[Relation with the deliverable] this work is concerned with the problem of transferring a grasp robustly to different initial hand-object poses for underactuated hands. The present work contributes to the goals of Task 4.4.
    \item[Attachment] (following pages until next annex)
\end{description}
\includepdf[pages=-]{./attachedPapers/LearningInferenceUnderactuatedHands.pdf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Article: A computational framework for environment-aware robotic manipulation planning} \label{ann:env-awareManipulation}
\begin{description}
    \item[Authors] M. Gabiccini, A. Artoni, G. Pannocchia, J.~Gillis
    \item[Info] Published in: 17th International Symposium on Robotics Research (ISRR), Sestri Levante (Genova), Italy, September 12-15, 2015
    \item[Abstract] In this paper, we present a computational framework for direct trajectory optimization of general manipulation systems with unspecified contact sequences, exploiting \emph{environmental constraints} as a key tool to accomplish a task.
    Two approaches are presented to describe the dynamics of systems with contacts, which are based on a penalty formulation and on a velocity-based time-stepping scheme, respectively. In  both cases, object and environment contact forces are included among the free optimization variables, and they are rendered consistent via suitably devised sets of complementarity conditions.
    To maximize computational efficiency, we exploit sparsity patterns in the linear algebra expressions generated during the solution of the optimization problem and leverage Algorithmic Differentiation to calculate derivatives. % quickly and accurately.
    The benefits of the proposed methods are evaluated in three simulated planar manipulation tasks, where essential interactions with environmental constraints are automatically synthesized and opportunistically exploited.
    \item[Relation with the deliverable] grasp and manipulation planning for systems with a-priori unspecified contact sequences.
    \item[Attachment] (following pages until next annex)
\end{description}
\includepdf[pages=-]{./attachedPapers/ComputationalFrameworkEnvAwareRobManipPlanning.pdf}
%\includepdf[pages=-]{./attachedPapers/appendix_of_ComputationalFrameworkEnvAwareRobManipPlanning.pdf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Article: Offset-free MPC explained: novelties, subtleties, and applications}
\label{ann:OffsetFreeMPCExplained}
\begin{description}
    \item[Authors] G. Pannocchia, M. Gabiccini, and A. Artoni
    \item[Info] Published in: 5th IFAC Conference on Nonlinear Model Predictive Control, Seville, Spain, September 17-20, 2015
    \item[Abstract]  This paper presents an updated and comprehensive description of offset-free MPC algorithms for nonlinear (and linear) discrete-time systems, with the intended objectives of clarifying the main concepts, showing new results, highlighting subtleties by means of challenging applications. First, the offset-free tracking problem for nonlinear systems is presented, putting a strong accent on the role of the disturbance model and observer, and then novel and stronger offset-free estimation results are presented. Next, recent advances in linear offset-free MPC are described, which show the equivalence of the velocity form algorithm (so far considered an alternative method) to a particular disturbance model and observer. Then, the concepts of offset-free estimation are exploited to design an offset-free economic MPC algorithm, which can asymptotically achieve the highest economic performance despite persistent model errors and disturbances. Extensive application results are presented to show the benefits of offset-free MPC algorithms over standard ones, and to clarify misconceptions and design errors that can prevent constraint satisfaction, closed-loop stability, and offset-free performance.
    \item[Relation with the deliverable] this work is concerned with providing the necessary theoretical background to design offset-free MPC algorithms, which are fundamental to turn direct trajectory optimization-based manipulation planners (presented in Sec.~\ref{sec:ComputationalFramework}) into controllers able to asymptotically achieve economic performances despite model errors and disturbances.
    \item[Attachment] (following pages until next annex)
\end{description}
\includepdf[pages=-]{./attachedPapers/OffsetFreeMPCExplained.pdf}


\end{document}
